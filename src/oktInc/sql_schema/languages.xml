<?xml version="1.0" encoding="UTF-8"?>
<database>

	<!-- core_languages -->
	<action id="core_languages" label="Create table %s" string="{{PREFIX}}core_languages">

		<test eq="neq" value="{{PREFIX}}core_languages" label="Table %s exists" type="wrn"
		string="{{PREFIX}}core_languages">SHOW TABLES LIKE '{{PREFIX}}core_languages'</test>

		CREATE TABLE `{{PREFIX}}core_languages` (
			`id` 				SERIAL,
			`title` 			VARCHAR(255) 				NOT NULL 	DEFAULT '',
			`code` 				VARCHAR(10) 				NOT NULL 	DEFAULT '',
			`img` 				VARCHAR(20) 				NOT NULL 	DEFAULT '',
			`active` 			TINYINT(1) 		UNSIGNED	NOT NULL 	DEFAULT 0,
			`ord` 				INT(10) 		UNSIGNED	NOT NULL 	DEFAULT 0,

			PRIMARY KEY (`id`),
			INDEX `{{PREFIX}}core_languages_active_idx` (`active`),
			INDEX `{{PREFIX}}core_languages_ord_idx` (`ord`)
		) ENGINE=MyISAM DEFAULT CHARSET=utf8 COLLATE utf8_general_ci ;
	</action>

	<!-- default core_languages -->
	<action id="firstlanguages" label="Creation des premieres langues" process="install">
		INSERT INTO `{{PREFIX}}core_languages`
			(`id`, `title`, `code`, `img`, `active`, `ord`)
		VALUES
			(1, 'Fran√ßais', 'fr', 'fr.png', 1, 1),
			(2, 'English', 'en', 'en.png', 0, 2) ;
	</action>

	<action id="add_core_languages_active" label="Add field %s" string="{{PREFIX}}core_languages.active" process="update">
		<test eq="neq" value="active" label="Field %s exists"
		string="{{PREFIX}}core_languages.active" type="wrn">
		SHOW COLUMNS FROM `{{PREFIX}}core_languages` LIKE 'active'
		</test>
		ALTER TABLE `{{PREFIX}}core_languages` ADD `active` TINYINT(1) UNSIGNED	NOT NULL DEFAULT 0 AFTER `code`
	</action>

	<action id="add_core_languages_active_idx" type="silent">
		ALTER TABLE `{{PREFIX}}core_languages` ADD INDEX `{{PREFIX}}core_languages_active_idx` (`active`)
	</action>

	<action id="add_core_languages_ord" label="Add field %s" string="{{PREFIX}}core_languages.ord" process="update">
		<test eq="neq" value="ord" label="Field %s exists"
		string="{{PREFIX}}core_languages.ord" type="wrn">
		SHOW COLUMNS FROM `{{PREFIX}}core_languages` LIKE 'ord'
		</test>
		ALTER TABLE `{{PREFIX}}core_languages` ADD `ord` INT(10) UNSIGNED NOT NULL DEFAULT 0 AFTER `active`
	</action>

	<action id="add_core_languages_ord_idx" type="silent">
		ALTER TABLE `{{PREFIX}}core_languages` ADD INDEX `{{PREFIX}}core_languages_ord_idx` (`ord`)
	</action>

	<action id="add_core_languages_img" label="Add field %s" string="{{PREFIX}}core_languages.img" process="update">
		<test eq="neq" value="img" label="Field %s exists"
		string="{{PREFIX}}core_languages.img" type="wrn">
		SHOW COLUMNS FROM `{{PREFIX}}core_languages` LIKE 'img'
		</test>
		ALTER TABLE `{{PREFIX}}core_languages` ADD `img` VARCHAR(20) NOT NULL DEFAULT '' AFTER `code`
	</action>

</database>